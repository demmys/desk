/*
 * main entry point
 */
main :: Int -> Char** -> 1;
main argc argv = primes 1000;

primes :: Int -> Int*;
primes n = sieve (list 2 n);

list :: Int -> Int -> Int*;
list a b =
    if a == b then
        a : []
    else
        a : (list ++a b);

sieve :: Int* -> Int*;
sieve l = sieve1 *l ++l;

sieve1 :: Int -> Int -> Int*;
sieve1 p xs =
    if xs == [] then
        p : []
    else
        p : sieve (sieve2 p *xs ++xs);

sieve2 :: Int -> Int -> Int* -> Int*;
sieve2 p x xs =
    if xs == [] then
        if x % p then x : [] else []
    else
        if x % p then x : sieve2 p *xs ++xs else sieve2 p *xs ++xs;
